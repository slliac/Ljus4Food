\hypertarget{class_c_i___security}{}\section{C\+I\+\_\+\+Security Class Reference}
\label{class_c_i___security}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_c_i___security_a095c5d389db211932136b53f25f39685}{\+\_\+\+\_\+construct}} ()
\item 
\mbox{\hyperlink{class_c_i___security_a03c037268db0c2e6221b65a736eaee07}{csrf\+\_\+verify}} ()
\item 
\mbox{\hyperlink{class_c_i___security_a55b1380b93b71ab3d9873bb967c2b9bb}{csrf\+\_\+set\+\_\+cookie}} ()
\item 
\mbox{\hyperlink{class_c_i___security_a3d09c1dc706abfaad987661805c28a06}{csrf\+\_\+show\+\_\+error}} ()
\item 
\mbox{\hyperlink{class_c_i___security_a1644fd8967db3a1b94988d730ca34991}{get\+\_\+csrf\+\_\+hash}} ()
\item 
\mbox{\hyperlink{class_c_i___security_a00640f51b90b7d946e9d3a4f0c9f628e}{get\+\_\+csrf\+\_\+token\+\_\+name}} ()
\item 
\mbox{\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean}} (\$str, \$is\+\_\+image=F\+A\+L\+SE)
\item 
\mbox{\hyperlink{class_c_i___security_ae2f831d3f277e1c03730b28fd1734186}{xss\+\_\+hash}} ()
\item 
\mbox{\hyperlink{class_c_i___security_a7d1d64e6798b98cb46fcdb304a4e1de2}{get\+\_\+random\+\_\+bytes}} (\$length)
\item 
\mbox{\hyperlink{class_c_i___security_a8bec9918f4d35c9e6340e1dc6a32ba14}{entity\+\_\+decode}} (\$str, \$charset=N\+U\+LL)
\item 
\mbox{\hyperlink{class_c_i___security_aaba16489285496bdc03fd12f699a08f6}{sanitize\+\_\+filename}} (\$str, \$relative\+\_\+path=F\+A\+L\+SE)
\item 
\mbox{\hyperlink{class_c_i___security_abb836a42971c7bc641588db779c6ab1d}{strip\+\_\+image\+\_\+tags}} (\$str)
\end{DoxyCompactItemize}
\subsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_c_i___security_a7ea55abf18a7d5ed32df02a8144b72e2}{\$filename\+\_\+bad\+\_\+chars}}
\item 
\mbox{\hyperlink{class_c_i___security_af10158dd74b75f1d337e83102d6b82ce}{\$charset}} = \textquotesingle{}U\+TF-\/8\textquotesingle{}
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_c_i___security_aed66bb1c40ccc25c96326da7c0e2088a}{\+\_\+urldecodespaces}} (\$\mbox{\hyperlink{_functions_8php_a8968a55c84671473daa2233e6cae65b8}{matches}})
\item 
\mbox{\hyperlink{class_c_i___security_adfb0e251ae35ae40303a302d253c3ab2}{\+\_\+compact\+\_\+exploded\+\_\+words}} (\$\mbox{\hyperlink{_functions_8php_a8968a55c84671473daa2233e6cae65b8}{matches}})
\item 
\mbox{\hyperlink{class_c_i___security_af67689597607833df370031fb799c92b}{\+\_\+sanitize\+\_\+naughty\+\_\+html}} (\$\mbox{\hyperlink{_functions_8php_a8968a55c84671473daa2233e6cae65b8}{matches}})
\item 
\mbox{\hyperlink{class_c_i___security_a6b1744acaf85e05c65ab17242dea4f06}{\+\_\+js\+\_\+link\+\_\+removal}} (\$match)
\item 
\mbox{\hyperlink{class_c_i___security_a5c5e91dc8e3df0174e4e074dd375a8db}{\+\_\+js\+\_\+img\+\_\+removal}} (\$match)
\item 
\mbox{\hyperlink{class_c_i___security_ae16451bcdc769285c499cbf8068b3523}{\+\_\+convert\+\_\+attribute}} (\$match)
\item 
\mbox{\hyperlink{class_c_i___security_aa385a9c7527f5eece656b9cac73979d3}{\+\_\+filter\+\_\+attributes}} (\$str)
\item 
\mbox{\hyperlink{class_c_i___security_a5289832cb3ae9cee3c12e82ede958874}{\+\_\+decode\+\_\+entity}} (\$match)
\item 
\mbox{\hyperlink{class_c_i___security_a61217e43f888cdf8afb1fba16b5cd9f6}{\+\_\+do\+\_\+never\+\_\+allowed}} (\$str)
\item 
\mbox{\hyperlink{class_c_i___security_a7064dd5501c1dfab05ba6ac8838beb01}{\+\_\+csrf\+\_\+set\+\_\+hash}} ()
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_c_i___security_aca426a0e87199bfa36c7401a1d06a419}{\$\+\_\+xss\+\_\+hash}}
\item 
\mbox{\hyperlink{class_c_i___security_a8bf24cc529f04164ac20d892ce20d721}{\$\+\_\+csrf\+\_\+hash}}
\item 
\mbox{\hyperlink{class_c_i___security_af86a83f20de2a3c522bf690d4080c08e}{\$\+\_\+csrf\+\_\+expire}} = 7200
\item 
\mbox{\hyperlink{class_c_i___security_a6752ebca4be235c079785a87a693d932}{\$\+\_\+csrf\+\_\+token\+\_\+name}} = \textquotesingle{}ci\+\_\+csrf\+\_\+token\textquotesingle{}
\item 
\mbox{\hyperlink{class_c_i___security_a52043f2c9ffb0e14eade8e67a0172a82}{\$\+\_\+csrf\+\_\+cookie\+\_\+name}} = \textquotesingle{}ci\+\_\+csrf\+\_\+token\textquotesingle{}
\item 
\mbox{\hyperlink{class_c_i___security_ab883fab930a1c4a926eaa501ab211823}{\$\+\_\+never\+\_\+allowed\+\_\+str}}
\item 
\mbox{\hyperlink{class_c_i___security_ac502ee17d09eb8bbd70a6fb1f9515503}{\$\+\_\+never\+\_\+allowed\+\_\+regex}}
\end{DoxyCompactItemize}


\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_c_i___security_a095c5d389db211932136b53f25f39685}\label{class_c_i___security_a095c5d389db211932136b53f25f39685}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+\+\_\+construct@{\+\_\+\+\_\+construct}}
\index{\+\_\+\+\_\+construct@{\+\_\+\+\_\+construct}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+construct()}{\_\_construct()}}
{\footnotesize\ttfamily \+\_\+\+\_\+construct (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Class constructor

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{class_c_i___security_adfb0e251ae35ae40303a302d253c3ab2}\label{class_c_i___security_adfb0e251ae35ae40303a302d253c3ab2}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+compact\+\_\+exploded\+\_\+words@{\+\_\+compact\+\_\+exploded\+\_\+words}}
\index{\+\_\+compact\+\_\+exploded\+\_\+words@{\+\_\+compact\+\_\+exploded\+\_\+words}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\+\_\+compact\+\_\+exploded\+\_\+words()}{\_compact\_exploded\_words()}}
{\footnotesize\ttfamily \+\_\+compact\+\_\+exploded\+\_\+words (\begin{DoxyParamCaption}\item[{}]{\$matches }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Compact Exploded Words

Callback method for \mbox{\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()}} to remove whitespace from things like \textquotesingle{}j a v a s c r i p t\textquotesingle{}.

-\/by \mbox{\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()}} 
\begin{DoxyParams}[1]{Parameters}
array & {\em \$matches} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_ae16451bcdc769285c499cbf8068b3523}\label{class_c_i___security_ae16451bcdc769285c499cbf8068b3523}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+convert\+\_\+attribute@{\+\_\+convert\+\_\+attribute}}
\index{\+\_\+convert\+\_\+attribute@{\+\_\+convert\+\_\+attribute}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\+\_\+convert\+\_\+attribute()}{\_convert\_attribute()}}
{\footnotesize\ttfamily \+\_\+convert\+\_\+attribute (\begin{DoxyParamCaption}\item[{}]{\$match }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Attribute Conversion

-\/by \mbox{\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()}} 
\begin{DoxyParams}[1]{Parameters}
array & {\em \$match} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_a7064dd5501c1dfab05ba6ac8838beb01}\label{class_c_i___security_a7064dd5501c1dfab05ba6ac8838beb01}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+csrf\+\_\+set\+\_\+hash@{\+\_\+csrf\+\_\+set\+\_\+hash}}
\index{\+\_\+csrf\+\_\+set\+\_\+hash@{\+\_\+csrf\+\_\+set\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\+\_\+csrf\+\_\+set\+\_\+hash()}{\_csrf\_set\_hash()}}
{\footnotesize\ttfamily \+\_\+csrf\+\_\+set\+\_\+hash (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Set C\+S\+RF Hash and Cookie

\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_a5289832cb3ae9cee3c12e82ede958874}\label{class_c_i___security_a5289832cb3ae9cee3c12e82ede958874}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+decode\+\_\+entity@{\+\_\+decode\+\_\+entity}}
\index{\+\_\+decode\+\_\+entity@{\+\_\+decode\+\_\+entity}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\+\_\+decode\+\_\+entity()}{\_decode\_entity()}}
{\footnotesize\ttfamily \+\_\+decode\+\_\+entity (\begin{DoxyParamCaption}\item[{}]{\$match }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

H\+T\+ML Entity Decode Callback

-\/by \mbox{\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()}} 
\begin{DoxyParams}[1]{Parameters}
array & {\em \$match} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_a61217e43f888cdf8afb1fba16b5cd9f6}\label{class_c_i___security_a61217e43f888cdf8afb1fba16b5cd9f6}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+do\+\_\+never\+\_\+allowed@{\+\_\+do\+\_\+never\+\_\+allowed}}
\index{\+\_\+do\+\_\+never\+\_\+allowed@{\+\_\+do\+\_\+never\+\_\+allowed}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\+\_\+do\+\_\+never\+\_\+allowed()}{\_do\_never\_allowed()}}
{\footnotesize\ttfamily \+\_\+do\+\_\+never\+\_\+allowed (\begin{DoxyParamCaption}\item[{}]{\$str }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Do Never Allowed

-\/by \mbox{\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()}} 
\begin{DoxyParams}{Parameters}
{\em string} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_aa385a9c7527f5eece656b9cac73979d3}\label{class_c_i___security_aa385a9c7527f5eece656b9cac73979d3}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+filter\+\_\+attributes@{\+\_\+filter\+\_\+attributes}}
\index{\+\_\+filter\+\_\+attributes@{\+\_\+filter\+\_\+attributes}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\+\_\+filter\+\_\+attributes()}{\_filter\_attributes()}}
{\footnotesize\ttfamily \+\_\+filter\+\_\+attributes (\begin{DoxyParamCaption}\item[{}]{\$str }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Filter Attributes

Filters tag attributes for consistency and safety.

-\/by \mbox{\hyperlink{class_c_i___security_a5c5e91dc8e3df0174e4e074dd375a8db}{C\+I\+\_\+\+Security\+::\+\_\+js\+\_\+img\+\_\+removal()}} -\/by \mbox{\hyperlink{class_c_i___security_a6b1744acaf85e05c65ab17242dea4f06}{C\+I\+\_\+\+Security\+::\+\_\+js\+\_\+link\+\_\+removal()}} 
\begin{DoxyParams}[1]{Parameters}
string & {\em \$str} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_a5c5e91dc8e3df0174e4e074dd375a8db}\label{class_c_i___security_a5c5e91dc8e3df0174e4e074dd375a8db}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+js\+\_\+img\+\_\+removal@{\+\_\+js\+\_\+img\+\_\+removal}}
\index{\+\_\+js\+\_\+img\+\_\+removal@{\+\_\+js\+\_\+img\+\_\+removal}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\+\_\+js\+\_\+img\+\_\+removal()}{\_js\_img\_removal()}}
{\footnotesize\ttfamily \+\_\+js\+\_\+img\+\_\+removal (\begin{DoxyParamCaption}\item[{}]{\$match }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

JS Image Removal

Callback method for \mbox{\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()}} to sanitize image tags.

This limits the P\+C\+RE backtracks, making it more performance friendly and prevents P\+R\+E\+G\+\_\+\+B\+A\+C\+K\+T\+R\+A\+C\+K\+\_\+\+L\+I\+M\+I\+T\+\_\+\+E\+R\+R\+OR from being triggered in P\+HP 5.\+2+ on image tag heavy strings.

-\/by \mbox{\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()}} 
\begin{DoxyParams}[1]{Parameters}
array & {\em \$match} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_a6b1744acaf85e05c65ab17242dea4f06}\label{class_c_i___security_a6b1744acaf85e05c65ab17242dea4f06}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+js\+\_\+link\+\_\+removal@{\+\_\+js\+\_\+link\+\_\+removal}}
\index{\+\_\+js\+\_\+link\+\_\+removal@{\+\_\+js\+\_\+link\+\_\+removal}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\+\_\+js\+\_\+link\+\_\+removal()}{\_js\_link\_removal()}}
{\footnotesize\ttfamily \+\_\+js\+\_\+link\+\_\+removal (\begin{DoxyParamCaption}\item[{}]{\$match }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

JS Link Removal

Callback method for \mbox{\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()}} to sanitize links.

This limits the P\+C\+RE backtracks, making it more performance friendly and prevents P\+R\+E\+G\+\_\+\+B\+A\+C\+K\+T\+R\+A\+C\+K\+\_\+\+L\+I\+M\+I\+T\+\_\+\+E\+R\+R\+OR from being triggered in P\+HP 5.\+2+ on link-\/heavy strings.

-\/by \mbox{\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()}} 
\begin{DoxyParams}[1]{Parameters}
array & {\em \$match} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_af67689597607833df370031fb799c92b}\label{class_c_i___security_af67689597607833df370031fb799c92b}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+sanitize\+\_\+naughty\+\_\+html@{\+\_\+sanitize\+\_\+naughty\+\_\+html}}
\index{\+\_\+sanitize\+\_\+naughty\+\_\+html@{\+\_\+sanitize\+\_\+naughty\+\_\+html}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\+\_\+sanitize\+\_\+naughty\+\_\+html()}{\_sanitize\_naughty\_html()}}
{\footnotesize\ttfamily \+\_\+sanitize\+\_\+naughty\+\_\+html (\begin{DoxyParamCaption}\item[{}]{\$matches }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

Sanitize Naughty H\+T\+ML

Callback method for \mbox{\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()}} to remove naughty H\+T\+ML elements.

-\/by \mbox{\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()}} 
\begin{DoxyParams}[1]{Parameters}
array & {\em \$matches} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_aed66bb1c40ccc25c96326da7c0e2088a}\label{class_c_i___security_aed66bb1c40ccc25c96326da7c0e2088a}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+urldecodespaces@{\+\_\+urldecodespaces}}
\index{\+\_\+urldecodespaces@{\+\_\+urldecodespaces}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\+\_\+urldecodespaces()}{\_urldecodespaces()}}
{\footnotesize\ttfamily \+\_\+urldecodespaces (\begin{DoxyParamCaption}\item[{}]{\$matches }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

U\+R\+L-\/decode taking spaces into account

\begin{DoxySeeAlso}{See also}
\href{https://github.com/bcit-ci/CodeIgniter/issues/4877}{\tt https\+://github.\+com/bcit-\/ci/\+Code\+Igniter/issues/4877} 
\end{DoxySeeAlso}

\begin{DoxyParams}[1]{Parameters}
array & {\em \$matches} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_a55b1380b93b71ab3d9873bb967c2b9bb}\label{class_c_i___security_a55b1380b93b71ab3d9873bb967c2b9bb}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!csrf\+\_\+set\+\_\+cookie@{csrf\+\_\+set\+\_\+cookie}}
\index{csrf\+\_\+set\+\_\+cookie@{csrf\+\_\+set\+\_\+cookie}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{csrf\+\_\+set\+\_\+cookie()}{csrf\_set\_cookie()}}
{\footnotesize\ttfamily csrf\+\_\+set\+\_\+cookie (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

C\+S\+RF Set Cookie

\begin{DoxyReturn}{Returns}
\mbox{\hyperlink{class_c_i___security}{C\+I\+\_\+\+Security}} 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_a3d09c1dc706abfaad987661805c28a06}\label{class_c_i___security_a3d09c1dc706abfaad987661805c28a06}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!csrf\+\_\+show\+\_\+error@{csrf\+\_\+show\+\_\+error}}
\index{csrf\+\_\+show\+\_\+error@{csrf\+\_\+show\+\_\+error}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{csrf\+\_\+show\+\_\+error()}{csrf\_show\_error()}}
{\footnotesize\ttfamily csrf\+\_\+show\+\_\+error (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Show C\+S\+RF Error

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_a03c037268db0c2e6221b65a736eaee07}\label{class_c_i___security_a03c037268db0c2e6221b65a736eaee07}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!csrf\+\_\+verify@{csrf\+\_\+verify}}
\index{csrf\+\_\+verify@{csrf\+\_\+verify}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{csrf\+\_\+verify()}{csrf\_verify()}}
{\footnotesize\ttfamily csrf\+\_\+verify (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

C\+S\+RF Verify

\begin{DoxyReturn}{Returns}
\mbox{\hyperlink{class_c_i___security}{C\+I\+\_\+\+Security}} 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_a8bec9918f4d35c9e6340e1dc6a32ba14}\label{class_c_i___security_a8bec9918f4d35c9e6340e1dc6a32ba14}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!entity\+\_\+decode@{entity\+\_\+decode}}
\index{entity\+\_\+decode@{entity\+\_\+decode}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{entity\+\_\+decode()}{entity\_decode()}}
{\footnotesize\ttfamily entity\+\_\+decode (\begin{DoxyParamCaption}\item[{}]{\$str,  }\item[{}]{\$charset = {\ttfamily NULL} }\end{DoxyParamCaption})}

H\+T\+ML Entities Decode

\mbox{\hyperlink{class_a}{A}} replacement for html\+\_\+entity\+\_\+decode()

The reason we are not using html\+\_\+entity\+\_\+decode() by itself is because while it is not technically correct to leave out the semicolon at the end of an entity most browsers will still interpret the entity correctly. html\+\_\+entity\+\_\+decode() does not convert entities without semicolons, so we are left with our own little solution here. Bummer.

\mbox{\hyperlink{}{string \$str Input  string \$charset Character set  string }}\mbox{\Hypertarget{class_c_i___security_a1644fd8967db3a1b94988d730ca34991}\label{class_c_i___security_a1644fd8967db3a1b94988d730ca34991}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!get\+\_\+csrf\+\_\+hash@{get\+\_\+csrf\+\_\+hash}}
\index{get\+\_\+csrf\+\_\+hash@{get\+\_\+csrf\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{get\+\_\+csrf\+\_\+hash()}{get\_csrf\_hash()}}
{\footnotesize\ttfamily get\+\_\+csrf\+\_\+hash (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Get C\+S\+RF Hash

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_c_i___security_a8bf24cc529f04164ac20d892ce20d721}{C\+I\+\_\+\+Security\+::\$\+\_\+csrf\+\_\+hash}} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
string C\+S\+RF hash 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_a00640f51b90b7d946e9d3a4f0c9f628e}\label{class_c_i___security_a00640f51b90b7d946e9d3a4f0c9f628e}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!get\+\_\+csrf\+\_\+token\+\_\+name@{get\+\_\+csrf\+\_\+token\+\_\+name}}
\index{get\+\_\+csrf\+\_\+token\+\_\+name@{get\+\_\+csrf\+\_\+token\+\_\+name}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{get\+\_\+csrf\+\_\+token\+\_\+name()}{get\_csrf\_token\_name()}}
{\footnotesize\ttfamily get\+\_\+csrf\+\_\+token\+\_\+name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Get C\+S\+RF Token Name

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_c_i___security_a6752ebca4be235c079785a87a693d932}{C\+I\+\_\+\+Security\+::\$\+\_\+csrf\+\_\+token\+\_\+name}} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
string C\+S\+RF token name 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_a7d1d64e6798b98cb46fcdb304a4e1de2}\label{class_c_i___security_a7d1d64e6798b98cb46fcdb304a4e1de2}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!get\+\_\+random\+\_\+bytes@{get\+\_\+random\+\_\+bytes}}
\index{get\+\_\+random\+\_\+bytes@{get\+\_\+random\+\_\+bytes}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{get\+\_\+random\+\_\+bytes()}{get\_random\_bytes()}}
{\footnotesize\ttfamily get\+\_\+random\+\_\+bytes (\begin{DoxyParamCaption}\item[{}]{\$length }\end{DoxyParamCaption})}

Get random bytes


\begin{DoxyParams}[1]{Parameters}
int & {\em \$length} & Output length \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_aaba16489285496bdc03fd12f699a08f6}\label{class_c_i___security_aaba16489285496bdc03fd12f699a08f6}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!sanitize\+\_\+filename@{sanitize\+\_\+filename}}
\index{sanitize\+\_\+filename@{sanitize\+\_\+filename}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{sanitize\+\_\+filename()}{sanitize\_filename()}}
{\footnotesize\ttfamily sanitize\+\_\+filename (\begin{DoxyParamCaption}\item[{}]{\$str,  }\item[{}]{\$relative\+\_\+path = {\ttfamily FALSE} }\end{DoxyParamCaption})}

Sanitize Filename


\begin{DoxyParams}[1]{Parameters}
string & {\em \$str} & Input file name \\
\hline
bool & {\em \$relative\+\_\+path} & Whether to preserve paths \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_abb836a42971c7bc641588db779c6ab1d}\label{class_c_i___security_abb836a42971c7bc641588db779c6ab1d}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!strip\+\_\+image\+\_\+tags@{strip\+\_\+image\+\_\+tags}}
\index{strip\+\_\+image\+\_\+tags@{strip\+\_\+image\+\_\+tags}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{strip\+\_\+image\+\_\+tags()}{strip\_image\_tags()}}
{\footnotesize\ttfamily strip\+\_\+image\+\_\+tags (\begin{DoxyParamCaption}\item[{}]{\$str }\end{DoxyParamCaption})}

Strip Image Tags


\begin{DoxyParams}[1]{Parameters}
string & {\em \$str} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\mbox{\Hypertarget{class_c_i___security_acb759426dbab128d3d8164805225381c}\label{class_c_i___security_acb759426dbab128d3d8164805225381c}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!xss\+\_\+clean@{xss\+\_\+clean}}
\index{xss\+\_\+clean@{xss\+\_\+clean}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{xss\+\_\+clean()}{xss\_clean()}}
{\footnotesize\ttfamily xss\+\_\+clean (\begin{DoxyParamCaption}\item[{}]{\$str,  }\item[{}]{\$is\+\_\+image = {\ttfamily FALSE} }\end{DoxyParamCaption})}

X\+SS Clean

Sanitizes data so that Cross Site Scripting Hacks can be prevented. This method does a fair amount of work but it is extremely thorough, designed to prevent even the most obscure X\+SS attempts. Nothing is ever 100\% foolproof, of course, but I haven\textquotesingle{}t been able to get anything passed the filter.

Note\+: Should only be used to deal with data upon submission. It\textquotesingle{}s not something that should be used for general runtime processing.

\mbox{\hyperlink{}{Based in part on some code and ideas from Bitflux.  \href{http://ha.ckers.org/xss.html}{\tt http\+://ha.\+ckers.\+org/xss.\+html} To help develop this script I used this great list of vulnerabilities along with a few other hacks I\textquotesingle{}ve harvested from examining vulnerabilities in other programs.  string$\vert$string\mbox{[}\mbox{]} \$str Input data  bool \$is\+\_\+image Whether the input is an image  string }}\mbox{\Hypertarget{class_c_i___security_ae2f831d3f277e1c03730b28fd1734186}\label{class_c_i___security_ae2f831d3f277e1c03730b28fd1734186}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!xss\+\_\+hash@{xss\+\_\+hash}}
\index{xss\+\_\+hash@{xss\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{xss\+\_\+hash()}{xss\_hash()}}
{\footnotesize\ttfamily xss\+\_\+hash (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

X\+SS Hash

Generates the X\+SS hash if needed and returns it.

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{class_c_i___security_aca426a0e87199bfa36c7401a1d06a419}{C\+I\+\_\+\+Security\+::\$\+\_\+xss\+\_\+hash}} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
string X\+SS hash 
\end{DoxyReturn}


\subsection{Field Documentation}
\mbox{\Hypertarget{class_c_i___security_a52043f2c9ffb0e14eade8e67a0172a82}\label{class_c_i___security_a52043f2c9ffb0e14eade8e67a0172a82}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+csrf\+\_\+cookie\+\_\+name@{\$\+\_\+csrf\+\_\+cookie\+\_\+name}}
\index{\$\+\_\+csrf\+\_\+cookie\+\_\+name@{\$\+\_\+csrf\+\_\+cookie\+\_\+name}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\$\+\_\+csrf\+\_\+cookie\+\_\+name}{$\_csrf\_cookie\_name}}
{\footnotesize\ttfamily \$\+\_\+csrf\+\_\+cookie\+\_\+name = \textquotesingle{}ci\+\_\+csrf\+\_\+token\textquotesingle{}\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_c_i___security_af86a83f20de2a3c522bf690d4080c08e}\label{class_c_i___security_af86a83f20de2a3c522bf690d4080c08e}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+csrf\+\_\+expire@{\$\+\_\+csrf\+\_\+expire}}
\index{\$\+\_\+csrf\+\_\+expire@{\$\+\_\+csrf\+\_\+expire}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\$\+\_\+csrf\+\_\+expire}{$\_csrf\_expire}}
{\footnotesize\ttfamily \$\+\_\+csrf\+\_\+expire = 7200\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_c_i___security_a8bf24cc529f04164ac20d892ce20d721}\label{class_c_i___security_a8bf24cc529f04164ac20d892ce20d721}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+csrf\+\_\+hash@{\$\+\_\+csrf\+\_\+hash}}
\index{\$\+\_\+csrf\+\_\+hash@{\$\+\_\+csrf\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\$\+\_\+csrf\+\_\+hash}{$\_csrf\_hash}}
{\footnotesize\ttfamily \$\+\_\+csrf\+\_\+hash\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_c_i___security_a6752ebca4be235c079785a87a693d932}\label{class_c_i___security_a6752ebca4be235c079785a87a693d932}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+csrf\+\_\+token\+\_\+name@{\$\+\_\+csrf\+\_\+token\+\_\+name}}
\index{\$\+\_\+csrf\+\_\+token\+\_\+name@{\$\+\_\+csrf\+\_\+token\+\_\+name}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\$\+\_\+csrf\+\_\+token\+\_\+name}{$\_csrf\_token\_name}}
{\footnotesize\ttfamily \$\+\_\+csrf\+\_\+token\+\_\+name = \textquotesingle{}ci\+\_\+csrf\+\_\+token\textquotesingle{}\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_c_i___security_ac502ee17d09eb8bbd70a6fb1f9515503}\label{class_c_i___security_ac502ee17d09eb8bbd70a6fb1f9515503}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+never\+\_\+allowed\+\_\+regex@{\$\+\_\+never\+\_\+allowed\+\_\+regex}}
\index{\$\+\_\+never\+\_\+allowed\+\_\+regex@{\$\+\_\+never\+\_\+allowed\+\_\+regex}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\$\+\_\+never\+\_\+allowed\+\_\+regex}{$\_never\_allowed\_regex}}
{\footnotesize\ttfamily \$\+\_\+never\+\_\+allowed\+\_\+regex\hspace{0.3cm}{\ttfamily [protected]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
= array(
        \textcolor{stringliteral}{'javascript\(\backslash\)s*:'},
        \textcolor{stringliteral}{'(\(\backslash\)(?document\(\backslash\))?|\(\backslash\)(?window\(\backslash\))?(\(\backslash\).document)?)\(\backslash\).(location|on\(\backslash\)w*)'},
        \textcolor{stringliteral}{'expression\(\backslash\)s*(\(\backslash\)(|&\(\backslash\)#40;)'}, 
        \textcolor{stringliteral}{'vbscript\(\backslash\)s*:'}, 
        \textcolor{stringliteral}{'wscript\(\backslash\)s*:'}, 
        \textcolor{stringliteral}{'jscript\(\backslash\)s*:'}, 
        \textcolor{stringliteral}{'vbs\(\backslash\)s*:'}, 
        \textcolor{stringliteral}{'Redirect\(\backslash\)s+30\(\backslash\)d'},
        \textcolor{stringliteral}{"([\(\backslash\)"'])?data\(\backslash\)s*:[^\(\backslash\)\(\backslash\)1]*?base64[^\(\backslash\)\(\backslash\)1]*?,[^\(\backslash\)\(\backslash\)1]*?\(\backslash\)\(\backslash\)1?"}
    )
\end{DoxyCode}
\mbox{\Hypertarget{class_c_i___security_ab883fab930a1c4a926eaa501ab211823}\label{class_c_i___security_ab883fab930a1c4a926eaa501ab211823}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+never\+\_\+allowed\+\_\+str@{\$\+\_\+never\+\_\+allowed\+\_\+str}}
\index{\$\+\_\+never\+\_\+allowed\+\_\+str@{\$\+\_\+never\+\_\+allowed\+\_\+str}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\$\+\_\+never\+\_\+allowed\+\_\+str}{$\_never\_allowed\_str}}
{\footnotesize\ttfamily \$\+\_\+never\+\_\+allowed\+\_\+str\hspace{0.3cm}{\ttfamily [protected]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=   array(
        \textcolor{stringliteral}{'document.cookie'} => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'(document).cookie'} => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'document.write'}  => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'(document).write'}  => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'.parentNode'}     => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'.innerHTML'}      => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'-moz-binding'}    => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'<!--'}            => \textcolor{stringliteral}{'&lt;!--'},
        \textcolor{stringliteral}{'-->'}             => \textcolor{stringliteral}{'--&gt;'},
        \textcolor{stringliteral}{'<![CDATA['}       => \textcolor{stringliteral}{'&lt;![CDATA['},
        \textcolor{stringliteral}{'<comment>'}   => \textcolor{stringliteral}{'&lt;comment&gt;'},
        \textcolor{stringliteral}{'<%'}              => \textcolor{stringliteral}{'&lt;&#37;'}
    )
\end{DoxyCode}
\mbox{\Hypertarget{class_c_i___security_aca426a0e87199bfa36c7401a1d06a419}\label{class_c_i___security_aca426a0e87199bfa36c7401a1d06a419}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+xss\+\_\+hash@{\$\+\_\+xss\+\_\+hash}}
\index{\$\+\_\+xss\+\_\+hash@{\$\+\_\+xss\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\$\+\_\+xss\+\_\+hash}{$\_xss\_hash}}
{\footnotesize\ttfamily \$\+\_\+xss\+\_\+hash\hspace{0.3cm}{\ttfamily [protected]}}

\mbox{\Hypertarget{class_c_i___security_af10158dd74b75f1d337e83102d6b82ce}\label{class_c_i___security_af10158dd74b75f1d337e83102d6b82ce}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$charset@{\$charset}}
\index{\$charset@{\$charset}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\$charset}{$charset}}
{\footnotesize\ttfamily \$charset = \textquotesingle{}U\+TF-\/8\textquotesingle{}}

\mbox{\Hypertarget{class_c_i___security_a7ea55abf18a7d5ed32df02a8144b72e2}\label{class_c_i___security_a7ea55abf18a7d5ed32df02a8144b72e2}} 
\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$filename\+\_\+bad\+\_\+chars@{\$filename\+\_\+bad\+\_\+chars}}
\index{\$filename\+\_\+bad\+\_\+chars@{\$filename\+\_\+bad\+\_\+chars}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection{\texorpdfstring{\$filename\+\_\+bad\+\_\+chars}{$filename\_bad\_chars}}
{\footnotesize\ttfamily \$filename\+\_\+bad\+\_\+chars}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=   array(
        \textcolor{stringliteral}{'../'}, \textcolor{stringliteral}{'<!--'}, \textcolor{stringliteral}{'-->'}, \textcolor{charliteral}{'<'}, \textcolor{charliteral}{'>'},
        \textcolor{stringliteral}{"'"}, \textcolor{charliteral}{'"'}, \textcolor{charliteral}{'&'}, \textcolor{charliteral}{'$'}, \textcolor{charliteral}{'#'},
        \textcolor{charliteral}{'\{'}, \textcolor{charliteral}{'\}'}, \textcolor{charliteral}{'['}, \textcolor{charliteral}{']'}, \textcolor{charliteral}{'='},
        \textcolor{charliteral}{';'}, \textcolor{charliteral}{'?'}, \textcolor{stringliteral}{'%20'}, \textcolor{stringliteral}{'%22'},
        \textcolor{stringliteral}{'%3c'},      
        \textcolor{stringliteral}{'%253c'},    
        \textcolor{stringliteral}{'%3e'},      
        \textcolor{stringliteral}{'%0e'},      
        \textcolor{stringliteral}{'%28'},      
        \textcolor{stringliteral}{'%29'},      
        \textcolor{stringliteral}{'%2528'},    
        \textcolor{stringliteral}{'%26'},      
        \textcolor{stringliteral}{'%24'},      
        \textcolor{stringliteral}{'%3f'},      
        \textcolor{stringliteral}{'%3b'},      
        \textcolor{stringliteral}{'%3d'}       
    )
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/\+Applications/\+X\+A\+M\+P\+P/xamppfiles/htdocs/\+Code\+Igniter/system/core/\mbox{\hyperlink{_security_8php}{Security.\+php}}\end{DoxyCompactItemize}
